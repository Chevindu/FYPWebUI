<html>

<head>
  <style>
    body {
      font-family: "Helvetica Neue", helvetica, arial;
      padding: 15px;
    }
    .clear {
      padding: 12px 32px;
      text-decoration: none;
      margin: 4px 2px;
      cursor: pointer;
      border-radius: 4px;
      }
  </style>

</head>

<body>
  <input style="width: 50%;height: 3em; border: 2px solid green; border-radius: 4px; padding: 12px 20px; margin: 8px 0; box-sizing: border-box;" 
  type="text" placeholder="Enter text here to send to server" id="eingabe" onkeypress="myFunction(event)" />

  <button class="clear" onclick="clearlog()">Clear Logs</button>

  <p>Type the message above and hit enter.</p>

  <div style="overflow:scroll; width: 50%; height: 300px; border: solid; border-radius: 9px; padding: 1em; margin-top: 1em" id="display"></div>

  <div style="margin:1em; float:left"><a href="/" target="_blank"><strong>Open the Server in new tab</strong></a></div>

  <script>

    var host = location.origin.replace(/^http/, 'ws');
    var ws = new WebSocket(host);
    var display = document.getElementById("display");

    ws.onopen = function (event) {
      //alert("Socket connected succesfully!!!")
      // ws.send("Host address: " + host);
      message = {from: 'robot', body: 'init_message'};
      ws.send(JSON.stringify(message));
      // setTimeout(function () { ws.send('connection succeeded'); }, 1000);
      display.innerHTML = "Socket connected succesfully!!! <br />";
    };

    ws.onmessage = function (event) {
      console.log("event.data value: ", event.data);
      display.innerHTML += "<strong>Web browser: </strong>" + event.data + "<br />";       //display input text in div (client side)
      // ws.send(document.getElementById('eingabe').value);

      /*var li = document.createElement('li');
      li.innerHTML = JSON.parse(event.data);
      document.querySelector('#pings').appendChild(li);*/

    };

    function myFunction(event) {
      //ws.send("Hello");
      if (event.which == 13 || event.keyCode == 13) {     //when enter is pressed...
        var text = document.getElementById('eingabe').value;    //assign value of the entered string to te text variable
        var message = {from: 'robot', body: text};
        if (text != "") {     //if text is not an empty string
          //display.innerHTML+="From Client: "+text+"<br />"; //show the message from client in div
          ws.send(JSON.stringify(message));    //send string to server
          console.log("Input: " + text);
          display.innerHTML += "<strong>Me: </strong>" + text + "<br />";       //display input text in div (client side)
          document.getElementById('eingabe').value = "";     //and clear the input field
        }
        else {
          console.log("empty string not sent")
        }
      }
    }

    function clearlog() {
      display.innerHTML = "";
    }
  </script>
</body>

</html>